#' Plot ROC and Precision-Recall curves.
#'
#' \code{autoplot} takes \code{curves} object generated by
#' \code{\link{evalmod}} or \code{\link{create_curves}}
#'  and plot ROC and Precion-Recall curves.
#' \code{autoplot} requires \code{\link[ggplot2]{ggplot2}} and
#' \code{\link[gridExtra]{grid.arrange}}.
#'
#' @param object \code{curves} object generated by
#'   \code{\link{evalmod}} or \code{\link{create_curves}}.
#' @param ... Other arguments (ignored).
#' @return \code{autoplot} automatically shows a plot or returns
#'   a \code{ggplot} object.
#'
#' @examples
#' library(ggplot2)
#' library(gridExtra)
#' data(P10N10)
#' curves <- evalmod(scores = P10N10$scores, labels = P10N10$labels)
#'
#' autoplot(curves)
autoplot.sscurves <- function(object, curvetype = c("ROC", "PRC"),
                              ret_grob = FALSE, ...) {
  # === Check package availability  ===
  .load_ggplot2()
  .validate(object)
  .check_curvetype(curvetype)
  .check_ret_grob(ret_grob)

  # === Create a ggplot object for ROC&PRC, ROC, or PRC ===
  if ("ROC" %in% curvetype) {
    p_roc <- ggplot2::autoplot(object[["rocs"]])
  }

  if ("PRC" %in% curvetype) {
    p_prc <- ggplot2::autoplot(object[["prcs"]])
  }

  if ("ROC" %in% curvetype && "PRC" %in% curvetype) {
    .load_grid()
    .load_gridExtra()

    grobframe <- gridExtra::arrangeGrob(p_roc, p_prc, ncol = 2)
    if (ret_grob) {
      grobframe
    } else {
      grid::grid.draw(grobframe)
    }
  } else if ("PRC" %in% curvetype) {
    p_prc
  } else if ("ROC" %in% curvetype) {
    p_roc
  }
}

#' Plot a ROC curve.
#'
#' \code{autoplot} takes \code{roc_curve} object generated by
#' \code{\link{create_roc}} and plot a ROC curve.
#' \code{autoplot} requires \code{\link[ggplot2]{ggplot2}}.
#'
#' @param object \code{roc_curve} object generated by
#'   \code{\link{create_roc}}.
#' @param ... Other arguments (ignored).
#' @return \code{autoplot} automatically shows a plot or returns
#'   a \code{ggplot} object.
#'
#' @examples
#' library(ggplot2)
#' data(P10N10)
#' curves <- evalmod(scores = P10N10$scores, labels = P10N10$labels)
#'
#' autoplot(curves[["rocs"]])
autoplot.ssroc <- function(object, ...) {
  ggplot2::autoplot(object[[1]], ...)
}

#' Plot a Precision-Recall curve.
#'
#' \code{autoplot} takes \code{prc_curve} object generated by
#' \code{\link{create_prc}} and plot a Precision-Recall curve.
#' \code{autoplot} requires \code{\link[ggplot2]{ggplot2}}.
#'
#' @param object \code{prc_curve} object generated by
#'   \code{\link{create_prc}}.
#' @param ... Other arguments (ignored).
#' @return \code{autoplot} automatically shows a plot or returns
#'   a \code{ggplot} object.
#'
#' @examples
#' library(ggplot2)
#' data(P10N10)
#' curves <- evalmod(scores = P10N10$scores, labels = P10N10$labels)
#'
#' autoplot(curves[["prcs"]])
autoplot.ssprc <- function(object, ...) {
  ggplot2::autoplot(object[[1]], ...)
}
