#' Plot ROC and Precision-Recall curves for multiple models.
#'
#' \code{autoplot} takes \code{mcurves} object generated by
#' \code{\link{evalmulti}} and plot ROC and Precion-Recall curves.
#' \code{autoplot} requires \code{\link[ggplot2]{ggplot2}} and
#' \code{\link[gridExtra]{grid.arrange}}.
#'
#' @param object \code{mcurves} object generated by
#'   \code{\link{evalmulti}}.
#' @param ... Other arguments (ignored).
#' @return \code{autoplot} automatically shows a plot or returns
#'   a \code{ggplot} object.
#'
#' @examples
#' library(ggplot2)
#' library(gridExtra)
#' s1 <- c(1, 2, 3, 4)
#' s2 <- c(5, 6, 7, 8)
#' s3 <- c(2, 4, 6, 8)
#' mscores <- join_scores(s1, s2, s3)
#'
#' l1 <- c(1, 0, 1, 1)
#' l2 <- c(1, 1, 0, 0)
#' l3 <- c(0, 1, 0, 1)
#' mobslabs <- join_labels(l1, l2, l3)
#'
#' model_names <- c("t1", "t2", "t3")
#' mdat <- mmdata(mscores, mobslabs)
#' mcurves <- evalmulti(mdat, model_names = model_names)
#'
#' autoplot(mcurves)
autoplot.mscurves <- function(object, curvetype = c("ROC", "PRC"), ...) {
  # === Check package availability  ===
  .load_ggplot2()
  .load_grid()
  .load_gridExtra()
  .validate(object)
  .check_curvetype(curvetype)

  # === Create a ggplot object for ROC&PRC, ROC, or PRC ===
  if ("ROC" %in% curvetype) {
    p_roc <- ggplot2::autoplot(object[["rocs"]])
  }

  if ("PRC" %in% curvetype) {
    p_prc <- ggplot2::autoplot(object[["prcs"]])
  }

  if ("ROC" %in% curvetype && "PRC" %in% curvetype) {
    .grid_arrange_shared_legend(p_roc, p_prc)
  } else if ("PRC" %in% curvetype) {
    p_prc
  } else if ("ROC" %in% curvetype) {
    p_roc
  }
}


# Plot ROC curves for multiple models
autoplot.msroc <- function(object, ...) {
  df <- .prepare_autoplot(object)

  # === Create a ggplot object ===
  p <- ggplot2::ggplot(df, aes(x = x, y = y, color = model_name))
  p <- .geom_roc_line_wrapper(p, object[[1]])
}

# Plot Precision-Recall curves for multiple models
autoplot.msprc <- function(object, ...) {
  df <- .prepare_autoplot(object)

  # === Create a ggplot object ===
  p <- ggplot2::ggplot(df, aes(x = x, y = y, color = model_name))
  p <- .geom_prc_line_wrapper(p, object[[1]])

  p
}
